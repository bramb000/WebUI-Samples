import{g as E,y as le,d as j,o as p,c as b,a as e,t as T,F as z,r as F,q as oe,h as V,_ as te,z as re,n as U,A as de,f as H,b as Y,m as ce,B as fe,p as pe,s as ve,C as me,u as ee,w as ue,i as he,k as be}from"./index-CRYThLUj.js";import{_ as xe}from"./ExperimentWrapper.vue_vue_type_script_setup_true_lang-DhXpNaHg.js";const ye={integer:"#EE4F94",add:"#4F8EEE",subtract:"#4F8EEE"};function ge(){return[{id:"int-a",type:"integer",label:"INT",position:{x:60,y:120},value:5,execInputs:[],execOutputs:[],inputs:[],outputs:[{id:"int-a-out",label:"",direction:"output",type:"number"}],shortDescription:"An integer",detailedInfo:{signature:"INT( value )",description:"Outputs a constant integer value that can be connected to other nodes as input.",params:[]},examplesData:{title:"INT",subtitle:"An integer",notes:["Integer values support whole numbers only.","To use decimal values, cast to a float or double data type."]}},{id:"int-b",type:"integer",label:"INT",position:{x:60,y:310},value:5,execInputs:[],execOutputs:[],inputs:[],outputs:[{id:"int-b-out",label:"",direction:"output",type:"number"}],shortDescription:"An integer",detailedInfo:{signature:"INT( value )",description:"Outputs a constant integer value that can be connected to other nodes as input.",params:[]},examplesData:{title:"INT",subtitle:"An integer",notes:["Integer values support whole numbers only.","To use decimal values, cast to a float or double data type."]}},{id:"add",type:"add",label:"ADD",position:{x:350,y:100},execInputs:[{id:"add-exec-in",label:"",direction:"input",type:"exec"}],execOutputs:[{id:"add-exec-out",label:"",direction:"output",type:"exec"}],inputs:[{id:"add-in1",label:"Number 1",direction:"input",type:"number"},{id:"add-in2",label:"Number 2",direction:"input",type:"number"}],outputs:[{id:"add-out",label:"Result",direction:"output",type:"number"}],shortDescription:"Add two numbers and output the result",detailedInfo:{signature:"ADD( value1, value2 )",description:"Add two numeric values. Automatically detect output type based on inputs.",params:[{name:"value1",description:"Accepts int, float, double"},{name:"value2",description:"Accepts int, float, double"}],examplesLink:"#"},examplesData:{title:"ADD",subtitle:"Add two numbers and output the result",notes:["If the output has a decimal point, the result will automatically be cast to double.","If both inputs are an integer, the result will automatically be an integer. You can choose to cast it to another data type."]}},{id:"int-c",type:"integer",label:"INT",position:{x:650,y:500},value:5e4,execInputs:[],execOutputs:[],inputs:[],outputs:[{id:"int-c-out",label:"",direction:"output",type:"number"}],shortDescription:"An integer",detailedInfo:{signature:"INT( value )",description:"Outputs a constant integer value that can be connected to other nodes as input.",params:[]},examplesData:{title:"INT",subtitle:"An integer",notes:["Integer values support whole numbers only.","To use decimal values, cast to a float or double data type."]}},{id:"subtract",type:"subtract",label:"SUB",position:{x:920,y:310},execInputs:[{id:"sub-exec-in",label:"",direction:"input",type:"exec"}],execOutputs:[{id:"sub-exec-out",label:"",direction:"output",type:"exec"}],inputs:[{id:"sub-in1",label:"Number 1",direction:"input",type:"number"},{id:"sub-in2",label:"Number 2",direction:"input",type:"number"}],outputs:[{id:"sub-out",label:"Result",direction:"output",type:"number"}],shortDescription:"Subtract number 2 from number 1",detailedInfo:{signature:"SUB( value1, value2 )",description:"Subtract the second numeric value from the first. Automatically detect output type based on inputs.",params:[{name:"value1",description:"Accepts int, float, double"},{name:"value2",description:"Accepts int, float, double"}],examplesLink:"#"},examplesData:{title:"SUB",subtitle:"Subtract number 2 from number 1",notes:["If the output has a decimal point, the result will automatically be cast to double.","If both inputs are an integer, the result will automatically be an integer. You can choose to cast it to another data type."]}}]}function Ie(){return[{id:"conn-1",fromNodeId:"int-a",fromPinId:"int-a-out",toNodeId:"add",toPinId:"add-in1"},{id:"conn-2",fromNodeId:"int-b",fromPinId:"int-b-out",toNodeId:"add",toPinId:"add-in2"},{id:"conn-3",fromNodeId:"add",fromPinId:"add-out",toNodeId:"subtract",toPinId:"sub-in1"},{id:"conn-4",fromNodeId:"int-c",fromPinId:"int-c-out",toNodeId:"subtract",toPinId:"sub-in2"},{id:"exec-1",fromNodeId:"add",fromPinId:"add-exec-out",toNodeId:"subtract",toPinId:"sub-exec-in"}]}function we(){const t=E(ge()),x=E(Ie()),n=le({active:!1,nodeId:null,offsetX:0,offsetY:0}),u=le({active:!1,fromNodeId:null,fromPinId:null,mouseX:0,mouseY:0}),l=E(null),w=E(!1),I=E(null);function y(c){return t.value.find(i=>i.id===c)}function a(c,i,N){const $=y(c);$&&($.position.x=i,$.position.y=N)}function D(c,i){const N=y(c);N&&N.type==="integer"&&(N.value=i)}function _(c,i,N){const $=y(c);$&&(n.active=!0,n.nodeId=c,n.offsetX=i-$.position.x,n.offsetY=N-$.position.y)}function X(c,i){!n.active||!n.nodeId||a(n.nodeId,c-n.offsetX,i-n.offsetY)}function W(){n.active=!1,n.nodeId=null}function d(c,i,N,$){u.active=!0,u.fromNodeId=c,u.fromPinId=i,u.mouseX=N,u.mouseY=$}function m(c,i){u.active&&(u.mouseX=c,u.mouseY=i)}function S(c,i){u.active&&c&&i&&u.fromNodeId&&u.fromPinId&&f(u.fromNodeId,u.fromPinId,c,i)&&o(u.fromNodeId,u.fromPinId,c,i),u.active=!1,u.fromNodeId=null,u.fromPinId=null}function f(c,i,N,$){if(c===N)return!1;const R=y(c),C=y(N);if(!R||!C)return!1;const q=[...R.outputs,...R.execOutputs],k=[...C.inputs,...C.execInputs],g=q.find(A=>A.id===i),P=k.find(A=>A.id===$);return!(!g||!P||g.type!==P.type||x.value.some(A=>A.toNodeId===N&&A.toPinId===$))}function o(c,i,N,$){const R=`conn-${Date.now()}`;x.value.push({id:R,fromNodeId:c,fromPinId:i,toNodeId:N,toPinId:$})}function r(c){x.value=x.value.filter(i=>i.id!==c)}function B(){w.value=!0,I.value=null;try{const c=new Map;t.value.forEach(k=>c.set(k.id,k));const i=new Map,N=new Map;t.value.forEach(k=>{i.set(k.id,0),N.set(k.id,[])}),x.value.forEach(k=>{var g;(g=N.get(k.fromNodeId))==null||g.push(k.toNodeId),i.set(k.toNodeId,(i.get(k.toNodeId)||0)+1)});const $=[];i.forEach((k,g)=>{k===0&&$.push(g)});const R=[];for(;$.length>0;){const k=$.shift();R.push(k);for(const g of N.get(k)||[]){const P=(i.get(g)||1)-1;i.set(g,P),P===0&&$.push(g)}}const C=new Map;for(const k of R){const g=c.get(k);if(g.type==="integer")C.set(g.id,g.value??0);else if(g.type==="add"){const P=x.value.filter(M=>M.toNodeId===g.id),L=P.find(M=>M.toPinId==="add-in1"),A=P.find(M=>M.toPinId==="add-in2");if(!L||!A)return I.value=`${g.label}: Missing input connection`,null;const J=C.get(L.fromNodeId)??0,Q=C.get(A.fromNodeId)??0;C.set(g.id,J+Q)}else if(g.type==="subtract"){const P=x.value.filter(M=>M.toNodeId===g.id),L=P.find(M=>M.toPinId==="sub-in1"),A=P.find(M=>M.toPinId==="sub-in2");if(!L||!A)return I.value=`${g.label}: Missing input connection`,null;const J=C.get(L.fromNodeId)??0,Q=C.get(A.fromNodeId)??0;C.set(g.id,J-Q)}}const q=C.get("subtract")??null;return l.value=q,setTimeout(()=>{w.value=!1},1500),q}catch{return I.value="Evaluation failed",w.value=!1,null}}return{dragState:n,wireDrag:u,nodes:t,connections:x,executionResult:l,isRunning:w,executionError:I,startNodeDrag:_,onNodeDrag:X,endNodeDrag:W,startWireDrag:d,onWireDrag:m,endWireDrag:S,addConnection:o,removeConnection:r,updateNodeValue:D,evaluate:B}}function ae(t,x){if(t.execInputs.some(d=>d.id===x))return{x:24,y:75};if(t.execOutputs.some(d=>d.id===x))return{x:345,y:75};if(t.type==="integer")return t.outputs.some(d=>d.id===x)?{x:143,y:76}:null;const X=t.outputs.findIndex(d=>d.id===x);if(X!==-1)return{x:349,y:110+X*26};const W=t.inputs.findIndex(d=>d.id===x);return W!==-1?{x:20,y:110+W*26}:null}const Ne={class:"info-panel",role:"region","aria-label":"Detailed node information"},$e={class:"info-content"},ke={class:"info-signature"},_e={class:"info-description"},De={class:"param-name"},Ce={class:"param-desc"},Ee=j({__name:"NodeInfoPanel",props:{info:{}},emits:["seeExamples"],setup(t,{emit:x}){const n=x;return(u,l)=>(p(),b("div",Ne,[l[1]||(l[1]=e("div",{class:"info-separator","aria-hidden":"true"},null,-1)),e("div",$e,[e("p",ke,T(t.info.signature),1),e("p",_e,T(t.info.description),1),(p(!0),b(z,null,F(t.info.params,w=>(p(),b("div",{key:w.name,class:"info-param"},[e("span",De,T(w.name),1),e("span",Ce,T(w.description),1)]))),128)),t.info.examplesLink?(p(),b("button",{key:0,class:"info-examples-link",onClick:l[0]||(l[0]=oe(w=>n("seeExamples"),["prevent"])),"aria-label":"See examples for this node"}," See examples ")):V("",!0)])]))}}),Pe=te(Ee,[["__scopeId","data-v-21bd78b3"]]),Ae=["data-node-id","data-node-type","aria-label"],Me=["aria-label"],Te={class:"node-title"},Xe={class:"node-subtitle"},Se={class:"node-body"},Oe={key:0,class:"exec-row"},Ye=["data-pin-id","onMouseup","aria-label"],Be=["data-pin-id","onMousedown","aria-label"],We={key:1,class:"int-row"},Re=["value","aria-label"],Ve=["data-pin-id","aria-label"],Ue={class:"pin-side pin-side--left"},Le=["data-pin-id","onMouseup","aria-label"],Ge={class:"pin-label"},ze={key:0,class:"pin-side pin-side--right"},Fe={class:"pin-label"},Ke=["data-pin-id","aria-label"],qe=["aria-expanded"],He=j({__name:"GraphNode",props:{node:{},connections:{}},emits:["startDrag","startWireDrag","pinDrop","updateValue","openExamples"],setup(t,{emit:x}){const n=t,u=x,l=E(!1),w=Y(()=>ye[n.node.type]),I=Y(()=>n.node.type==="integer"),y=Y(()=>I.value?163:369);function a(f){return n.connections.some(o=>o.fromPinId===f&&o.fromNodeId===n.node.id||o.toPinId===f&&o.toNodeId===n.node.id)}function D(f){f.preventDefault(),u("startDrag",n.node.id,f.clientX,f.clientY)}function _(f,o){o.preventDefault(),o.stopPropagation(),u("startWireDrag",n.node.id,f,o.clientX,o.clientY)}function X(f){u("pinDrop",n.node.id,f)}function W(f){const o=parseInt(f.target.value);isNaN(o)||u("updateValue",n.node.id,o)}function d(f){f.key==="Escape"&&l.value&&(l.value=!1,f.stopPropagation())}function m(){u("openExamples",n.node.id)}const S=Y(()=>I.value?`${n.node.label} node, value ${n.node.value}`:`${n.node.label} node: ${n.node.shortDescription}`);return(f,o)=>(p(),b("div",{class:U(["graph-node",{"graph-node--compact":I.value,"graph-node--wide":!I.value}]),style:re({left:t.node.position.x+"px",top:t.node.position.y+"px",width:y.value+"px","--header-color":w.value}),"data-node-id":t.node.id,"data-node-type":t.node.type,role:"group","aria-label":S.value,tabindex:"0",onKeydown:d},[e("div",{class:"node-header",onMousedown:D,role:"button","aria-label":`Drag to move ${t.node.label} node`},[e("span",Te,T(t.node.label),1),e("span",Xe,T(t.node.shortDescription),1)],40,Me),e("div",Se,[I.value?V("",!0):(p(),b("div",Oe,[(p(!0),b(z,null,F(t.node.execInputs,r=>(p(),b("div",{key:r.id,class:U(["exec-pin exec-pin--in",{connected:a(r.id)}]),"data-pin-id":r.id,"data-pin-dir":"input",onMouseup:B=>X(r.id),role:"button","aria-label":`Execution input${a(r.id)?", connected":""}`,tabindex:"0"},[...o[5]||(o[5]=[e("svg",{width:"12",height:"14",viewBox:"0 0 12 14","aria-hidden":"true"},[e("polygon",{points:"1,1 11,7 1,13",fill:"currentColor"})],-1)])],42,Ye))),128)),(p(!0),b(z,null,F(t.node.execOutputs,r=>(p(),b("div",{key:r.id,class:U(["exec-pin exec-pin--out",{connected:a(r.id)}]),"data-pin-id":r.id,"data-pin-dir":"output",onMousedown:B=>_(r.id,B),role:"button","aria-label":`Execution output${a(r.id)?", connected":""}`,tabindex:"0"},[...o[6]||(o[6]=[e("svg",{width:"12",height:"14",viewBox:"0 0 12 14","aria-hidden":"true"},[e("polygon",{points:"1,1 11,7 1,13",fill:"currentColor"})],-1)])],42,Be))),128))])),I.value?(p(),b("div",We,[e("input",{type:"number",class:"int-value-input",value:t.node.value,onInput:W,"aria-label":`Value for ${t.node.label} node`},null,40,Re),t.node.outputs[0]?(p(),b("div",{key:0,class:U(["data-pin data-pin--output",{connected:a(t.node.outputs[0].id)}]),"data-pin-id":t.node.outputs[0].id,"data-pin-dir":"output",onMousedown:o[0]||(o[0]=r=>_(t.node.outputs[0].id,r)),role:"button","aria-label":`Output pin${a(t.node.outputs[0].id)?", connected":""}`,tabindex:"0"},null,42,Ve)):V("",!0)])):V("",!0),I.value?V("",!0):(p(!0),b(z,{key:2},F(t.node.inputs,(r,B)=>(p(),b("div",{key:r.id,class:"pin-row"},[e("div",Ue,[e("div",{class:U(["data-pin data-pin--input",{connected:a(r.id)}]),"data-pin-id":r.id,"data-pin-dir":"input",onMouseup:c=>X(r.id),role:"button","aria-label":`${r.label} input${a(r.id)?", connected":""}`,tabindex:"0"},null,42,Le),e("span",Ge,T(r.label),1)]),B===0&&t.node.outputs[0]?(p(),b("div",ze,[e("span",Fe,T(t.node.outputs[0].label),1),e("div",{class:U(["data-pin data-pin--output",{connected:a(t.node.outputs[0].id)}]),"data-pin-id":t.node.outputs[0].id,"data-pin-dir":"output",onMousedown:o[1]||(o[1]=c=>_(t.node.outputs[0].id,c)),role:"button","aria-label":`${t.node.outputs[0].label} output${a(t.node.outputs[0].id)?", connected":""}`,tabindex:"0"},null,42,Ke)])):V("",!0)]))),128)),e("div",{class:"more-info-toggle",onClick:o[2]||(o[2]=r=>l.value=!l.value),role:"button","aria-expanded":l.value,"aria-label":"Toggle more information",tabindex:"0",onKeydown:[o[3]||(o[3]=de(oe(r=>l.value=!l.value,["prevent"]),["enter"])),o[4]||(o[4]=de(oe(r=>l.value=!l.value,["prevent"]),["space"]))]},[(p(),b("svg",{width:"8",height:"8",viewBox:"0 0 8 8",class:U(["toggle-chevron",{open:l.value}]),"aria-hidden":"true"},[...o[7]||(o[7]=[e("polygon",{points:"1,0.5 7,4 1,7.5",fill:"currentColor"},null,-1)])],2)),o[8]||(o[8]=e("span",null,"More info",-1))],40,qe),l.value?(p(),H(Pe,{key:3,info:t.node.detailedInfo,onSeeExamples:m},null,8,["info"])):V("",!0)])],46,Ae))}}),je=te(He,[["__scopeId","data-v-673d338f"]]),Je=["aria-label"],Qe=["d"],Ze=["d","stroke","stroke-width"],et=["transform","aria-label"],tt=j({__name:"GraphWire",props:{connection:{},nodes:{}},emits:["disconnect"],setup(t,{emit:x}){const n=t,u=x,l=E(!1),w=Y(()=>n.nodes.find(d=>d.id===n.connection.fromNodeId)),I=Y(()=>n.nodes.find(d=>d.id===n.connection.toNodeId)),y=Y(()=>{const d=w.value;return d?d.execOutputs.some(m=>m.id===n.connection.fromPinId):!1}),a=Y(()=>{const d=w.value;if(!d)return{x:0,y:0};const m=ae(d,n.connection.fromPinId);return m?{x:d.position.x+m.x,y:d.position.y+m.y}:{x:0,y:0}}),D=Y(()=>{const d=I.value;if(!d)return{x:0,y:0};const m=ae(d,n.connection.toPinId);return m?{x:d.position.x+m.x,y:d.position.y+m.y}:{x:0,y:0}}),_=Y(()=>{const d=a.value.x,m=a.value.y,S=D.value.x,f=D.value.y,o=Math.abs(S-d)*.5;return`M ${d} ${m} C ${d+o} ${m}, ${S-o} ${f}, ${S} ${f}`}),X=Y(()=>({x:(a.value.x+D.value.x)/2,y:(a.value.y+D.value.y)/2}));function W(d){d.stopPropagation(),u("disconnect",n.connection.id)}return(d,m)=>{var S,f,o,r;return p(),b("g",{class:U(["graph-wire",{"graph-wire--exec":y.value}]),onMouseenter:m[0]||(m[0]=B=>l.value=!0),onMouseleave:m[1]||(m[1]=B=>l.value=!1),role:"group","aria-label":`${y.value?"Execution":"Data"} wire from ${(S=w.value)==null?void 0:S.label} to ${(f=I.value)==null?void 0:f.label}`},[e("path",{d:_.value,fill:"none",stroke:"transparent","stroke-width":"16",style:{cursor:"pointer"}},null,8,Qe),e("path",{d:_.value,fill:"none",stroke:l.value?"var(--wire-hover, #999)":"var(--wire-color, #AAA)","stroke-width":l.value?3:2,"stroke-linecap":"round",style:{transition:"stroke-width 0.15s ease, stroke 0.15s ease"}},null,8,Ze),l.value?(p(),b("g",{key:0,class:"disconnect-btn",transform:`translate(${X.value.x}, ${X.value.y})`,onClick:W,style:{cursor:"pointer"},role:"button","aria-label":`Disconnect ${y.value?"execution":"data"} wire from ${(o=w.value)==null?void 0:o.label} to ${(r=I.value)==null?void 0:r.label}`,tabindex:"0"},[...m[2]||(m[2]=[e("circle",{r:"10",fill:"var(--wire-disconnect-bg, #E53E3E)",opacity:"0.95"},null,-1),e("line",{x1:"-3.5",y1:"-3.5",x2:"3.5",y2:"3.5",stroke:"white","stroke-width":"1.5","stroke-linecap":"round"},null,-1),e("line",{x1:"3.5",y1:"-3.5",x2:"-3.5",y2:"3.5",stroke:"white","stroke-width":"1.5","stroke-linecap":"round"},null,-1)])],8,et)):V("",!0)],42,Je)}}}),nt=te(tt,[["__scopeId","data-v-8c426bbe"]]),ot=["data-theme"],at={class:"modal-header"},it={id:"modal-title",class:"modal-title"},st={class:"modal-subtitle"},lt={class:"modal-section"},dt={class:"modal-syntax-visual"},ut={class:"syntax-placeholder","aria-label":"Visual example of node connection syntax"},rt={class:"syntax-node syntax-node--op",style:{top:"10px",left:"180px"}},ct={class:"sn-header sn-header--op"},pt={class:"sn-title"},ft={class:"sn-sub"},vt={class:"modal-section"},mt={class:"modal-notes"},ht=j({__name:"ExamplesModal",props:{data:{},theme:{default:"light"}},emits:["close"],setup(t,{emit:x}){const n=x,u=E(null),l=E(null);function w(y){y.target===y.currentTarget&&n("close")}function I(y){if(y.key==="Escape"&&n("close"),y.key==="Tab"&&u.value){const a=u.value.querySelectorAll('button, [tabindex]:not([tabindex="-1"]), input, a[href]');if(a.length===0)return;const D=a[0],_=a[a.length-1];y.shiftKey&&document.activeElement===D?(y.preventDefault(),_.focus()):!y.shiftKey&&document.activeElement===_&&(y.preventDefault(),D.focus())}}return ce(()=>{document.addEventListener("keydown",I),fe(()=>{var y;(y=l.value)==null||y.focus()})}),pe(()=>{document.removeEventListener("keydown",I)}),(y,a)=>(p(),H(ve,{to:"body"},[e("div",{class:"modal-backdrop","data-theme":t.theme,onClick:w,role:"dialog","aria-modal":"true","aria-labelledby":"modal-title"},[e("div",{class:"modal-card",ref_key:"modalRef",ref:u},[e("button",{ref_key:"closeButtonRef",ref:l,class:"modal-close",onClick:a[0]||(a[0]=D=>n("close")),"aria-label":"Close examples dialog"},[...a[1]||(a[1]=[e("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none","aria-hidden":"true"},[e("line",{x1:"3",y1:"3",x2:"13",y2:"13",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round"}),e("line",{x1:"13",y1:"3",x2:"3",y2:"13",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round"})],-1)])],512),e("div",at,[e("h2",it,T(t.data.title),1),e("p",st,T(t.data.subtitle),1)]),e("div",lt,[a[7]||(a[7]=e("h3",{class:"modal-section-title"},"Syntax",-1)),e("div",dt,[e("div",ut,[a[4]||(a[4]=e("div",{class:"syntax-node syntax-node--int",style:{top:"10px",left:"10px"}},[e("div",{class:"sn-header sn-header--int"},[e("span",{class:"sn-title"},"INT"),e("span",{class:"sn-sub"},"An integer")]),e("div",{class:"sn-body"},[e("span",{class:"sn-value"},"5"),e("span",{class:"sn-dot sn-dot--filled"})])],-1)),e("div",rt,[e("div",ct,[e("span",pt,T(t.data.title),1),e("span",ft,T(t.data.subtitle),1)]),a[2]||(a[2]=e("div",{class:"sn-exec-row"},[e("div",{class:"sn-exec-pin sn-exec-pin--in"},[e("svg",{width:"10",height:"12",viewBox:"0 0 12 14","aria-hidden":"true"},[e("polygon",{points:"1,1 11,7 1,13"})])]),e("div",{class:"sn-exec-pin sn-exec-pin--out"},[e("svg",{width:"10",height:"12",viewBox:"0 0 12 14","aria-hidden":"true"},[e("polygon",{points:"1,1 11,7 1,13"})])])],-1)),a[3]||(a[3]=e("div",{class:"sn-body sn-body--op"},[e("div",{class:"sn-pin-row"},[e("div",{class:"sn-pin-left"},[e("span",{class:"sn-dot"}),e("span",{class:"sn-label"},"Number 1")]),e("div",{class:"sn-pin-right"},[e("span",{class:"sn-label"},"Result"),e("span",{class:"sn-dot"})])]),e("div",{class:"sn-pin-row"},[e("div",{class:"sn-pin-left"},[e("span",{class:"sn-dot"}),e("span",{class:"sn-label"},"Number 2")])])],-1))]),a[5]||(a[5]=e("div",{class:"syntax-node syntax-node--int",style:{top:"150px",left:"10px"}},[e("div",{class:"sn-header sn-header--int"},[e("span",{class:"sn-title"},"INT"),e("span",{class:"sn-sub"},"An integer")]),e("div",{class:"sn-body"},[e("span",{class:"sn-value"},"5"),e("span",{class:"sn-dot sn-dot--filled"})])],-1)),a[6]||(a[6]=e("svg",{class:"syntax-wires",width:"100%",height:"100%"},[e("path",{d:"M 130 50 C 155 50, 165 90, 190 90",fill:"none",stroke:"#AAA","stroke-width":"2","stroke-linecap":"round"}),e("path",{d:"M 130 192 C 155 192, 165 115, 190 115",fill:"none",stroke:"#AAA","stroke-width":"2","stroke-linecap":"round"})],-1))])])]),e("div",vt,[a[8]||(a[8]=e("h3",{class:"modal-section-title"},"Notes",-1)),e("div",mt,[(p(!0),b(z,null,F(t.data.notes,(D,_)=>(p(),b("p",{key:_,class:"modal-note"},T(D),1))),128))])])],512)],8,ot)]))}}),bt=te(ht,[["__scopeId","data-v-93ae6406"]]),xt=["data-theme"],yt={class:"canvas-grid",width:"100%",height:"100%","aria-hidden":"true"},gt=["x","y","width","height"],It=["cx","cy","r"],wt={class:"canvas-toolbar",role:"toolbar","aria-label":"Node graph controls"},Nt={class:"toolbar-actions"},$t=["aria-label"],kt={key:0,width:"18",height:"18",viewBox:"0 0 18 18","aria-hidden":"true"},_t=["x1","y1","x2","y2"],Dt={key:1,width:"18",height:"18",viewBox:"0 0 18 18","aria-hidden":"true"},Ct={class:"wire-layer","aria-label":"Node connections"},Et={key:0,class:"wire-drag-layer"},Pt=["d"],At=.25,Mt=3,Tt=j({__name:"NodeGraphCanvas",props:{theme:{default:"light"}},setup(t){const{nodes:x,connections:n,dragState:u,wireDrag:l,startNodeDrag:w,onNodeDrag:I,endNodeDrag:y,startWireDrag:a,onWireDrag:D,endWireDrag:_,removeConnection:X,updateNodeValue:W}=we(),d=t,m=E(d.theme);me(()=>d.theme,s=>{m.value=s});function S(){m.value=m.value==="light"?"dark":"light"}const f=E(0),o=E(0),r=E(!1),B=E(0),c=E(0),i=E(1);function N(s){s.preventDefault();const v=-s.deltaY*.001,O=Math.min(Mt,Math.max(At,i.value*(1+v)));if(O===i.value)return;const G=s.currentTarget.getBoundingClientRect(),Z=s.clientX-G.left,ne=s.clientY-G.top,se=O/i.value;f.value=Z-(Z-f.value)*se,o.value=ne-(ne-o.value)*se,i.value=O}function $(s){s.button===1&&(s.preventDefault(),r.value=!0,B.value=s.clientX-f.value,c.value=s.clientY-o.value)}function R(s){r.value&&s.preventDefault()}const C=E(null);function q(s){const h=x.value.find(v=>v.id===s);h!=null&&h.examplesData&&(C.value=h.examplesData)}function k(){C.value=null}function g(s){if(r.value){f.value=s.clientX-B.value,o.value=s.clientY-c.value;return}if(u.active&&I(s.clientX,s.clientY),l.active){const h=document.querySelector(".node-graph-canvas");if(h){const v=h.getBoundingClientRect();D(s.clientX-v.left,s.clientY-v.top)}}}function P(s){if(r.value&&s.button===1){r.value=!1;return}if(u.active&&y(),l.active){const v=s.target.closest("[data-pin-id]");if(v&&v.dataset.pinDir==="input"){const O=v.closest("[data-node-id]");if(O){_(O.dataset.nodeId,v.dataset.pinId);return}}_()}}function L(s,h,v){w(s,h,v)}function A(s,h,v,O){const K=document.querySelector(".node-graph-canvas");if(K){const G=K.getBoundingClientRect();a(s,h,v-G.left,O-G.top)}else a(s,h,v,O)}function J(s,h){l.active&&_(s,h)}function Q(s){X(s)}function M(s,h){W(s,h)}const ie=Y(()=>{if(!l.active||!l.fromNodeId||!l.fromPinId)return"";const s=x.value.find(ne=>ne.id===l.fromNodeId);if(!s)return"";const h=ae(s,l.fromPinId);if(!h)return"";const v=s.position.x+h.x,O=s.position.y+h.y,K=(l.mouseX-f.value)/i.value,G=(l.mouseY-o.value)/i.value,Z=Math.abs(K-v)*.5;return`M ${v} ${O} C ${v+Z} ${O}, ${K-Z} ${G}, ${K} ${G}`});return ce(()=>{window.addEventListener("mousemove",g),window.addEventListener("mouseup",P)}),pe(()=>{window.removeEventListener("mousemove",g),window.removeEventListener("mouseup",P)}),(s,h)=>(p(),b("div",{class:U(["node-graph-canvas",{"is-panning":r.value}]),"data-theme":m.value,onMousedown:$,onContextmenu:R,onWheel:oe(N,["prevent"])},[(p(),b("svg",yt,[e("defs",null,[e("pattern",{id:"dot-pattern",x:f.value%(24*i.value),y:o.value%(24*i.value),width:24*i.value,height:24*i.value,patternUnits:"userSpaceOnUse"},[e("circle",{cx:12*i.value,cy:12*i.value,r:Math.max(.5,1*i.value),fill:"var(--grid-dot)"},null,8,It)],8,gt)]),h[0]||(h[0]=e("rect",{width:"100%",height:"100%",fill:"url(#dot-pattern)"},null,-1))])),e("div",wt,[e("div",Nt,[e("button",{class:"theme-toggle",onClick:S,"aria-label":`Switch to ${m.value==="light"?"dark":"light"} mode`,title:"Toggle Theme"},[m.value==="light"?(p(),b("svg",kt,[h[1]||(h[1]=e("circle",{cx:"9",cy:"9",r:"4",fill:"none",stroke:"currentColor","stroke-width":"1.5"},null,-1)),(p(),b(z,null,F(8,v=>e("line",{key:v,x1:9+6.5*Math.cos((v*45-90)*Math.PI/180),y1:9+6.5*Math.sin((v*45-90)*Math.PI/180),x2:9+8*Math.cos((v*45-90)*Math.PI/180),y2:9+8*Math.sin((v*45-90)*Math.PI/180),stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round"},null,8,_t)),64))])):(p(),b("svg",Dt,[...h[2]||(h[2]=[e("path",{d:"M15 10.5a6 6 0 01-7.5-7.5A6 6 0 1015 10.5z",fill:"none",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"},null,-1)])]))],8,$t)])]),e("div",{class:"canvas-content",style:re({transform:`translate(${f.value}px, ${o.value}px) scale(${i.value})`})},[(p(),b("svg",Ct,[(p(!0),b(z,null,F(ee(n),v=>(p(),H(nt,{key:v.id,connection:v,nodes:ee(x),onDisconnect:Q},null,8,["connection","nodes"]))),128))])),(p(!0),b(z,null,F(ee(x),v=>(p(),H(je,{key:v.id,node:v,connections:ee(n),onStartDrag:L,onStartWireDrag:A,onPinDrop:J,onUpdateValue:M,onOpenExamples:q},null,8,["node","connections"]))),128)),ee(l).active&&ie.value?(p(),b("svg",Et,[e("path",{d:ie.value,fill:"none",stroke:"var(--wire-color)","stroke-width":"2","stroke-dasharray":"6 3"},null,8,Pt)])):V("",!0)],4),h[3]||(h[3]=e("div",{class:"canvas-hint","aria-hidden":"true"},' Drag headers to move · Drag output pins to connect · Hover wires to disconnect · Click "More info" for details ',-1)),C.value?(p(),H(bt,{key:0,data:C.value,theme:m.value,onClose:k},null,8,["data","theme"])):V("",!0)],42,xt))}}),Xt=te(Tt,[["__scopeId","data-v-4473080a"]]),Yt=j({__name:"NodeGraphView",setup(t){return(x,n)=>(p(),H(xe,{title:"Node Graph Experiment",tags:["Vue 3","SVG & Mouse Events","State Management"],"storybook-id":"components-nodegraph-nodegraph--default","footer-note":"Tip: Use the scroll wheel to zoom and middle-mouse button to pan.","container-class":"h-[75vh] min-h-[600px] relative"},{description:ue(()=>[...n[0]||(n[0]=[be(" A canvas-based node editor built from scratch in Vue. Features include infinite panning, smooth zooming, bezier wire connections, and a reactive data flow engine. ",-1)])]),default:ue(()=>[he(Xt)]),_:1}))}});export{Yt as default};
